{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Owner/Dropbox/My PC (LAPTOP-M9TB4ITQ)/Desktop/SocialMediaApp/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"C:/Users/Owner/Dropbox/My PC (LAPTOP-M9TB4ITQ)/Desktop/SocialMediaApp/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/Users/Owner/Dropbox/My PC (LAPTOP-M9TB4ITQ)/Desktop/SocialMediaApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Owner/Dropbox/My PC (LAPTOP-M9TB4ITQ)/Desktop/SocialMediaApp/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{React,useState}from\"react\";import{likePost,deletePost}from\"../api\";import moment from\"moment\";import Card from\"@mui/material/Card\";import Button from\"@mui/material/Button\";import CardHeader from\"@mui/material/CardHeader\";import CardMedia from\"@mui/material/CardMedia\";import CardContent from\"@mui/material/CardContent\";import CardActions from\"@mui/material/CardActions\";import Avatar from\"@mui/material/Avatar\";import IconButton from\"@mui/material/IconButton\";import Typography from\"@mui/material/Typography\";import Grid from\"@mui/material/Grid\";import{red}from\"@mui/material/colors\";import DeleteIcon from\"@mui/icons-material/Delete\";import ThumbUpAltIcon from\"@mui/icons-material/ThumbUpAlt\";import ThumbUpAltOutlined from\"@mui/icons-material/ThumbUpAltOutlined\";import MoreVertIcon from\"@mui/icons-material/MoreVert\";import{useAuth}from\"../auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post,setCurrentId=_ref.setCurrentId;var _useAuth=useAuth(),authTokens=_useAuth.authTokens;var _useState=useState(post===null||post===void 0?void 0:post.likes),_useState2=_slicedToArray(_useState,2),likes=_useState2[0],setLikes=_useState2[1];//const user = JSON.parse(authTokens)?.oldUser ;\nvar getUser=function getUser(){if(authTokens){var _JSON$parse;return(_JSON$parse=JSON.parse(authTokens))===null||_JSON$parse===void 0?void 0:_JSON$parse.oldUser;}else return null;};var user=getUser();console.log(user);var hasLikedPost=post.likes.find(function(like){return like===user&&user._id;});var handleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:likePost(post._id);if(hasLikedPost){setLikes(post.likes.filter(function(id){return id!==user&&user._id;}));}else{setLikes([].concat(_toConsumableArray(post.likes),[user&&user._id]));}case 2:case\"end\":return _context.stop();}},_callee);}));return function handleLike(){return _ref2.apply(this,arguments);};}();var Likes=function Likes(){if(likes.length>0){return likes.find(function(like){return like===user&&user._id;})?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltIcon,{fontSize:\"small\"}),\"\\xA0\",likes.length>2?\"You and \".concat(likes.length-1,\" others\"):\"\".concat(likes.length,\" like\").concat(likes.length>1?\"s\":\"\")]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltOutlined,{fontSize:\"small\"}),\"\\xA0\",likes.length,\" \",likes.length===1?\"Like\":\"Likes\"]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ThumbUpAltOutlined,{fontSize:\"small\"}),\"\\xA0Like\"]});};return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{sx:{maxWidth:345},children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{sx:{bgcolor:red[500]},\"aria-label\":\"recipe\",children:\"R\"}),action:/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return setCurrentId(post._id);},\"aria-label\":\"settings\",children:/*#__PURE__*/_jsx(MoreVertIcon,{})}),title:post.title,subheader:moment(post.createdAt).fromNow()}),/*#__PURE__*/_jsx(CardMedia,{component:\"img\",height:\"194\",image:post.selectedFile,alt:\"postImage\"}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:post.message}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:post.tags.map(function(tag){return\"#\".concat(tag,\" \");})})]}),/*#__PURE__*/_jsxs(CardActions,{disableSpacing:true,children:[/*#__PURE__*/_jsx(Button,{size:\"small\",color:\"primary\",disabled:!authTokens,onClick:handleLike,children:/*#__PURE__*/_jsx(Likes,{})}),user&&(user===null||user===void 0?void 0:user._id)===(post===null||post===void 0?void 0:post.creator)&&/*#__PURE__*/_jsxs(Button,{size:\"small\",color:\"secondary\",onClick:function onClick(){return deletePost(post._id);},children:[/*#__PURE__*/_jsx(DeleteIcon,{fontSize:\"small\"}),\" \\xA0 Delete\"]})]})]},post._id)},post._id);}","map":{"version":3,"names":["React","useState","likePost","deletePost","moment","Card","Button","CardHeader","CardMedia","CardContent","CardActions","Avatar","IconButton","Typography","Grid","red","DeleteIcon","ThumbUpAltIcon","ThumbUpAltOutlined","MoreVertIcon","useAuth","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Post","_ref","post","setCurrentId","_useAuth","authTokens","_useState","likes","_useState2","_slicedToArray","setLikes","getUser","_JSON$parse","JSON","parse","oldUser","user","console","log","hasLikedPost","find","like","_id","handleLike","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","filter","id","concat","_toConsumableArray","stop","apply","arguments","Likes","length","children","fontSize","item","xs","sm","md","sx","maxWidth","avatar","bgcolor","action","onClick","title","subheader","createdAt","fromNow","component","height","image","selectedFile","alt","variant","color","message","tags","map","tag","disableSpacing","size","disabled","creator"],"sources":["C:/Users/Owner/Dropbox/My PC (LAPTOP-M9TB4ITQ)/Desktop/SocialMediaApp/client/src/Components/Post.jsx"],"sourcesContent":["import { React, useState } from \"react\";\r\nimport { likePost, deletePost } from \"../api\";\r\nimport moment from \"moment\";\r\nimport Card from \"@mui/material/Card\";\r\nimport Button from \"@mui/material/Button\";\r\nimport CardHeader from \"@mui/material/CardHeader\";\r\nimport CardMedia from \"@mui/material/CardMedia\";\r\nimport CardContent from \"@mui/material/CardContent\";\r\nimport CardActions from \"@mui/material/CardActions\";\r\nimport Avatar from \"@mui/material/Avatar\";\r\nimport IconButton from \"@mui/material/IconButton\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport Grid from \"@mui/material/Grid\";\r\nimport { red } from \"@mui/material/colors\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport ThumbUpAltIcon from \"@mui/icons-material/ThumbUpAlt\";\r\nimport ThumbUpAltOutlined from \"@mui/icons-material/ThumbUpAltOutlined\";\r\nimport MoreVertIcon from \"@mui/icons-material/MoreVert\";\r\nimport { useAuth } from \"../auth\";\r\n\r\nexport default function Post({ post, setCurrentId}) {\r\n  const { authTokens } = useAuth();\r\n  const [likes, setLikes] = useState(post?.likes);\r\n  //const user = JSON.parse(authTokens)?.oldUser ;\r\n  const getUser = () =>{\r\n    if(authTokens){\r\n      return JSON.parse(authTokens)?.oldUser\r\n    }\r\n    else return null\r\n  }\r\n  const user=getUser();\r\n  console.log(user);\r\n  const hasLikedPost = post.likes.find((like) => like === user && user._id);\r\n  const handleLike = async () => {\r\n     likePost(post._id);\r\n\r\n    if (hasLikedPost) {\r\n      setLikes(post.likes.filter((id) => id !== user && user._id));\r\n    } else {\r\n      setLikes([...post.likes, user && user._id]);\r\n    }\r\n  };\r\n\r\n  const Likes = () => {\r\n    if (likes.length > 0) {\r\n      return likes.find((like) => like === user && user._id) ? (\r\n        <>\r\n          <ThumbUpAltIcon fontSize=\"small\" />\r\n          &nbsp;\r\n          {likes.length > 2\r\n            ? `You and ${likes.length - 1} others`\r\n            : `${likes.length} like${likes.length > 1 ? \"s\" : \"\"}`}\r\n        </>\r\n      ) : (\r\n        <>\r\n          <ThumbUpAltOutlined fontSize=\"small\" />\r\n          &nbsp;{likes.length} {likes.length === 1 ? \"Like\" : \"Likes\"}\r\n        </>\r\n      );\r\n    }\r\n    \r\n\r\n    return (\r\n      <>\r\n        <ThumbUpAltOutlined fontSize=\"small\" />\r\n        &nbsp;Like\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Grid item key={post._id} xs={12} sm={6} md={4}>\r\n      <Card key={post._id} sx={{ maxWidth: 345 }}>\r\n        <CardHeader\r\n          avatar={\r\n            <Avatar sx={{ bgcolor: red[500] }} aria-label=\"recipe\">\r\n              R\r\n            </Avatar>\r\n          }\r\n          action={\r\n            <IconButton\r\n              onClick={() => setCurrentId(post._id)}\r\n              aria-label=\"settings\"\r\n            >\r\n              <MoreVertIcon />\r\n            </IconButton>\r\n          }\r\n          title={post.title}\r\n          subheader={moment(post.createdAt).fromNow()}\r\n        />\r\n        <CardMedia\r\n          component=\"img\"\r\n          height=\"194\"\r\n          image={post.selectedFile}\r\n          alt=\"postImage\"\r\n        />\r\n        <CardContent>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">\r\n            {post.message}\r\n          </Typography>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">\r\n            {post.tags.map((tag) => `#${tag} `)}\r\n          </Typography>\r\n        </CardContent>\r\n        <CardActions disableSpacing>\r\n          <Button\r\n            size=\"small\"\r\n            color=\"primary\"\r\n            disabled={!authTokens}\r\n            onClick={handleLike}\r\n          >\r\n           <Likes />\r\n           </Button>\r\n           {user && user?._id === post?.creator && (\r\n             <Button\r\n               size=\"small\"\r\n               color=\"secondary\"\r\n               onClick={() => deletePost(post._id)}\r\n             >\r\n               <DeleteIcon fontSize=\"small\" /> &nbsp; Delete\r\n             </Button>\r\n           )}\r\n         </CardActions>\r\n       </Card>\r\n     </Grid>\r\n    )\r\n  }\r\n    "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}